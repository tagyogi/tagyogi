<!--
	시스템구분 : 홈페이지
	파일정보 : lendInterCalc.html
	파일명 : lendInterCalc.html
	업무명 : 이자견적조회
	생성자 : 변성균
	생성일 : 2023.08.11
-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xml:lang="ko">
	
	<script th:inline="javascript">
		/*<![CDATA[*/
		
		//화면 초기화 처리 호출
		$(document).ready(function(){
			//lnb 세팅함수
			fnPageLnbSet(/*[[${menuInfo}]]*/, "이자납입현황"); //lnb세팅
			
			//내용조회
			var param = /*[[${paramMap}]]*/;
			obj = {url:"/lendInter/selectLendInter.do", param:param, callBack:fnSerchCallBack, msgYn:"N", sessYn:"Y", loadYn:"Y"};
			com.fnAjaxDef(obj);
			
		});
		
		var fnSerchCallBack = function(resData){
			
			let lendType = resData.data.lendType;
			//조합원정보
			com.fnSetKeyVal(resData.memb);
			
			//약정정보
			//console.log(resData.contr);
			com.fnSetKeyVal(resData.contr);
			
			$("#ele_limitAmt").text(com.addComma(resData.contr["limitAmt"+lendType]));
			$("#ele_useAmt").text(com.addComma(resData.contr["useAmt"+lendType]));
			let remainAmt = Number(resData.contr["limitAmt"+lendType]) - Number(resData.contr["useAmt"+lendType]);
			$("#ele_remainAmt").text(com.addComma(remainAmt));
			
			//대출정보
			com.fnSetKeyVal(resData.data);
			
			var sumInterAmt = 0; //이자금액 합계
			var sumPayAmt = 0; //이자납입액 합계
			var sumRemainAmt = 0; //이자미납액 합계
			var sumDelayAmt = 0; //연체이자액 합계
			var sumDelayPayAmt = 0; //연체납입액 합계
			
			//이자납입현황리스트
			$.each(resData.list, function(index, item) {
				sumInterAmt = sumInterAmt + item.interAmt; //이자금액 합계
				sumPayAmt = sumPayAmt + item.totPayAmt; //이자납입액 합계
				sumRemainAmt = sumRemainAmt + item.interDefaultAmt; //이자미납액 합계
				sumDelayAmt = sumDelayAmt + item.delayAmt; //연체이자액 합계
				sumDelayPayAmt = sumDelayPayAmt + item.delayPayAmt; //연체납입액 합계
				
				var html  = '<tr>';
					html += '<td class="alignC">'+ item.interSeq  + '</td>'; //번호
					html += '<td class="alignC">'+ item.interTermDt + '</td>'; //이자납입기간
					//일수
					if(item.interDays !== null && item.interDays >= 0){
						html += '<td class="alignC">'+ item.interDays +'일</td>';
					}else{
						html += '<td class="alignC"></td>';
					}
					html += '<td class="alignR">'+ com.addComma(item.interAmt) + '</td>'; //이자금액
					html += '<td class="alignC">'+ com.fnDateFormat(item.payDt) +'</td>'; //납입일자
					html += '<td class="alignR">'+ com.addComma(item.totPayAmt) + '</td>'; //이자납입액
					html += '<td class="alignR">'+ com.addComma(item.interDefaultAmt) + '</td>'; //이자미납액
					//연체기간
					if(item.delayBegDt !== null){
						html += '<td class="alignC">'+ com.fnDateFormat(item.delayBegDt) + " ~ " + com.fnDateFormat(item.delayEndDt) +'</td>'; //연체기간
					}else{
						html += '<td class="alignC"></td>';
					}
					//일수
					if(item.delayDays !== null && item.delayDays >= 0){
						html += '<td class="alignC">'+ item.delayDays +'</td>';
					}else{
						html += '<td class="alignC"></td>';
					}
					//연체이자액
					if(item.delayAmt !== null && item.delayAmt > 0){
						html += '<td class="alignR">'+ com.addComma(item.delayAmt) + '</td>';
					}else{
						html += '<td class="alignR"></td>';
					}
					html += '<td class="alignR">'+ com.addComma(item.delayPayAmt) + '</td>'; //연체납입액
					html += '</tr>';
					
					if(index === resData.list.length -1){
						html += '<tr>'
						html += '<th colspan="3">합계</td>';
						html += '<td class="alignR" style="font-size:14px;font-weight:bold">'+ com.addComma(sumInterAmt) + '</td>'; //이자금액 합계
						html += '<td class="alignC"></td>';
						html += '<td class="alignR" style="font-size:14px;font-weight:bold">'+ com.addComma(sumPayAmt) + '</td>'; //이자납입액 합계
						html += '<td class="alignR" style="font-size:14px;font-weight:bold">'+ com.addComma(sumRemainAmt) + '</td>'; //이자미납액 합계
						html += '<th colspan="2"></td>';
						html += '<td class="alignR" style="font-size:14px;font-weight:bold">'+ com.addComma(sumDelayAmt) + '</td>'; //연체이자액 합계
						html += '<td class="alignR" style="font-size:14px;font-weight:bold">'+ com.addComma(sumDelayPayAmt) + '</td>'; //연체납입액 합계
						html += '</tr>';
					}
					
				$("#ele_lendInterList").append(html);
			});
		}
		/*]]>*/
	</script>
        <div class="main-top sub">
			<ul class="inner">
                <li class="move1"></li>
                <li class="move2"></li>
                <li class="move3"></li>
                <li class="move4"></li>
                <li class="move5"></li>
            </ul>
        </div>
        <div class="content-wrap">
            <div class="inner">
                <div class="content-box flex-box jc-between">
                    <!-- 업무 안내 영역 -->
                    <div id="lnb" class="lnb-wrap">
                        <h3 class="ko-bold h3-txt"></h3>
                        
                    </div>

                    <!-- 업무 안내 영역 끝 -->
                    <div class="content-main">
						<!-- 경로 영역 시작 -->
                        <div th:insert="~{/fragments/subTitle}"></div>
                        <!-- 경로 영역 끝 -->
                        <section id="content" class="content">
                            <!-- 여기서부터 content -->
                            <div>
                                <article>
                                    <p class="title-dept1">조합원정보</p>
                                    <div class="table-wrap info">
                                        <div class="table-scroll">
                                            <table summary="조합원정보">
                                                <colgroup>
                                                	<col style="width:12%;">
                                                	<col style="width:23%;">
                                                	<col style="width:12%;">
                                                	<col style="width:18%;">
                                                	<col style="width:12%;">
                                                	<col style="width:23%;">
                                                </colgroup>
                                                <tbody>
                                                    <tr>
                                                        <th>조합원</th>
                                                        <td><span id="ele_membNo"></span>&nbsp;/&nbsp;<span id="ele_membNm"></span></td>
                                                        <th>대표자</th>
                                                        <td><span id="ele_ceoNm"></span></td>
                                                        <th>주장르</th>
                                                        <td><span id="ele_mainBussNm"></span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>사업자번호</th>
                                                        <td><span id="ele_bizNo"></span></td>
                                                        <th>법인등록번호</th>
                                                        <td><span id="ele_lawNo"></span></td>
                                                        <th>소속단체</th>
                                                        <td><span id="ele_belong"></span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>전화번호</th>
                                                        <td><span id="ele_telNo"></span></td>
                                                        <th>주소</th>
                                                        <td colspan="3"><span id="ele_addrFull"></span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>신용도</th>
                                                        <td><span id="ele_grade"></span></td>
                                                        <th>약정구분</th>
                                                        <td><span id="ele_contrTypeNm"></span></td>
                                                        <th>약정기간</th>
                                                        <td><span id="ele_contrTermDt"></span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>대출한도</th>
                                                        <td><span id="ele_limitAmt"></span></td>
                                                        <th>대출총액</th>
                                                        <td><span id="ele_useAmt"></span></td>
                                                        <th>대출가능금액</th>
                                                        <td><span id="ele_remainAmt"></span></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </article>
                                <article>
                                    <p class="title-dept1">대출정보</p>
                                    <div class="table-wrap info">
                                        <div class="table-scroll">
                                            <table summary="대출정보">
												<colgroup>
                                                	<col style="width:12%;">
                                                	<col style="width:23%;">
                                                	<col style="width:12%;">
                                                	<col style="width:18%;">
                                                	<col style="width:12%;">
                                                	<col style="width:23%;">
                                                </colgroup>
                                                <tbody>
													<tr>
                                                        <th>대출번호</th>
                                                        <td><span id="ele_lendNo"></span></td>
                                                        <th>대출종류</th>
                                                        <td><span id="ele_lendTypeNm"></span></td>
                                                        <th>대출구분</th>
                                                        <td><span id="ele_lendNm"></span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>대출일자</th>
                                                        <td><span id="ele_lendDt"></span></td>
                                                        <th>상환기한</th>
                                                        <td><span id="ele_repayPreDt"></span></td>
                                                        <th>대출상태</th>
                                                        <td><span id="ele_lendStatNm"></span></td>
                                                    </tr>
                                                    <tr>
                                                       	<th>대출금액</th>
                                                        <td><span id="ele_lendAmt"></span></td>
                                                        <th>상환금액</th>
                                                        <td><span id="ele_repayAmt"></span></td>
                                                        <th>대출잔액</th>
                                                        <td><span id="ele_remainLendAmt"></span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>비고</th>
                                                        <td colspan="4"><span id="ele_remark"></span></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </article>
                                <article>
									<p class="title-dept1">이자정보</p>
                                    <div class="table-wrap board">
                                        <div class="v2">
                                            <table class="border" summary="이자정보">
												<colgroup>
                                                	<col style="width:5%;">
                                                	<col style="width:22%;">
                                                	<col style="width:6%;">
                                                	<col style="width:10%;">
                                                	<col style="width:12%;">
                                                	<col style="width:10%;">
                                                	<col style="width:10%;">
                                                	<col style="width:22%;">
                                                	<col style="width:6%;">
                                                	<col style="width:7%;">
                                                	<col style="width:7%;">
                                                </colgroup>
                                                <thead class="back-gray">
                                                    <tr>
                                                        <th scope="col">차수</th>
                                                        <th scope="col">이자납입기간</th>
                                                        <th scope="col">일수</th>
                                                        <th scope="col">이자금액</th>
                                                        <th scope="col">납입일자</th>
                                                        <th scope="col">이자 납입액</th>
                                                        <th scope="col">이자 미납액</th>
                                                        <th scope="col">연체기간</th>
                                                        <th scope="col">일수</th>
                                                        <th scope="col">연체 이자액</th>
                                                        <th scope="col">연체 납입액</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="ele_lendInterList"></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </div>
</html>