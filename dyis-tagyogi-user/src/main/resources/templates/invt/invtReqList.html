<!--
	시스템구분 : 홈페이지 
	파일정보 : invtReqList.html
	파일명 : invtReqList.html
	업무명 : 추가출자신청현황
	생성자 : 변성균
	생성일 : 2023.08.11
-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xml:lang="ko">
	
	<script th:inline="javascript">
		/*<![CDATA[*/
		var codeList = /*[[${codeList}]]*/ //공통코드
		
		//화면 초기화 처리 호출
		$(document).ready(function(){
			//lnb 세팅함수
			fnPageLnbSet(/*[[${menuInfo}]]*/); //lnb세팅
			
			$("#sInvtStaDt").val(com.fnDateGet(/*[[${today}]]*/, -90)); //발급일자 시작일설정
			$("#sInvtEndDt").val(com.fnDateGet(/*[[${today}]]*/, 0)); //발급일자 종료알 설정
			
			fnSerch();
		});
		
		var fnSerch = function(){
			obj = {url:"/invtReq/selectInvtReqList.do", formId:"serchFrm", callBack:fnSerchCallBack, msgYn:"N", sessYn:"Y", loadYn:"Y"};
			com.fnAjaxPost(obj);
			
		}
		
		var fnInvtInsPage = function(e){
			var investNo = $(e).find(' > input[name="investNoSet"]').val();
			var procStat = $(e).find(' > input[name="procStatSet"]').val();
			
			var param = {investNo:investNo, procStat:procStat};
			
			if(investNo === undefined){
				param = {investNo: null};
			}
			fnPage('2030106', param);
		}
		
		var fnSerchCallBack = function(resData){
			//console.log(resData.data);
			var memb = resData.memb; //총출자금, 출자담보금
			
			$("#investAmt").text(com.addComma(memb.investAmt));
			$("#investNum").text(memb.investNum);
			$("#mortAmt").text(com.addComma(memb.mortAmt));
			$("#mortNum").text(memb.mortNum);
			
			$("#ele_invtReq").empty();//초기화
			
			if(resData.data.length === 0) $("#ele_invtReq").append('<tr><td colspan=8">정보가 없습니다.</td></tr>');
			
			$.each(resData.data, function(index, item) {
				var html  = "<tr onclick='fnInvtInsPage(this)'>";
					html += '<input type="hidden" name="investNoSet" value="'+ item.investNo +'"/>'; 
					html += '<input type="hidden" name="procStatSet" value="'+ item.procStat +'"/>';
					html += '<td class="alignC">'+ Number(index + 1)  + '</td>'; //순번
					html += '<td class="alignC">'+ item.investNm + '</td>'; //출자구분
					html += '<td class="alignC">'+ com.fnDateFormat(item.investDt) + '</td>'; //출자일자
					html += '<td class="alignR">'+ com.addComma(item.dealAmt) +'원</td>'; //좌당액면가
					html += '<td class="alignR">'+ item.investNum +'좌</td>'; //출자좌수
					html += '<td class="alignR">'+ com.addComma(item.investAmt) +'원</td>'; //출자금액
					html += '<td class="alignC">'+ com.fnNvlChk(com.fnDateFormat(item.procDt)) +'</td>'; //처리일자
					html += '<td class="alignC">'+ item.procStat +'</td>'; //처리상태
					html += '</tr>';
					
				$("#ele_invtReq").append(html);
			});
		}
		
		/*]]>*/
	</script>
        <div class="main-top sub">
			<ul class="inner">
                <li class="move1"></li>
                <li class="move2"></li>
                <li class="move3"></li>
                <li class="move4"></li>
                <li class="move5"></li>
            </ul>
        </div>
        <div class="content-wrap">
            <div class="inner">
                <div class="content-box flex-box jc-between">
                    <!-- 업무 안내 영역 -->
                    <div id="lnb" class="lnb-wrap">
                        <h3 class="ko-bold h3-txt"></h3>
                        
                    </div>

                    <!-- 업무 안내 영역 끝 -->
                    <div class="content-main">
						<!-- 경로 영역 시작 -->
                        <div th:insert="~{/fragments/subTitle}"></div>
                        <!-- 경로 영역 끝 -->
                        <form name="serchFrm" id="serchFrm" onSubmit="return false">
						<input type="hidden" th:name="_csrf" th:value="${_csrf?.token}"/>
                        <section id="content" class="content">
                            <!-- 여기서부터 content -->
                            <div>
                                <article>
                                    <form action="" method="get" name="search">
										<input type="hidden" th:name="_csrf" th:value="${_csrf?.token}"/>
										<input type="hidden" name="investNo" id="investNo" value=""/>
										<div class="search-wrap txt-border-wrap">
                                            <table class="block">
												<colgroup>
                                                    <col style="width:11%;">
                                                    <col style="width:45%;">
                                                    <col style="width:44%;">
                                                </colgroup>
                                                <tbody>
													<tr>
                                                        <th>출자일자</th>
                                                        <td>
                                                            <div class="flex-box al-center gap-10">
                                                                <div class="flex-box al-center datepicker-wrap">
                                                                    <input type="text" name="sInvtStaDt" id="sInvtStaDt" value="" maxlength="10" class="w-100" title="출자일 입력" placeholder="YYYY-MM-DD" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this)" onblur="com.fnDateValiChk(this);" autocomplete="off"/>
                                                                	<img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'sInvtStaDt', 'yyyy-mm-dd','sInvtEndDt', 1, '')" />
                                                                </div>
                                                                ~
                                                                <div class="flex-box al-center datepicker-wrap">
                                                                    <input type="text" name="sInvtEndDt" id="sInvtEndDt" value="" maxlength="10" class="w-100" title="출자일 입력" placeholder="YYYY-MM-DD" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this)" onblur="com.fnDateValiChk(this);" autocomplete="off" />
                                                                    <img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'sInvtEndDt', 'yyyy-mm-dd', 'sInvtStaDt', 2, '')" />
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <div class="alignR btn-position">
												<button type="button" class="sub-btn btn-color blue m-w-100 onlyPc" onClick="fnInvtInsPage()">신청</button>
												<button type="button" class="sub-btn btn-black m-w-100" onClick="fnSerch()">검색</button>
											</div>
                                        </div>
                                    </form>
                                </article>
                                <article class="mb20">
                                    <div class="table-wrap info">
										<div class="table-scroll">
	                                        <table class="w-500">
												<colgroup>
                                                    <col style="width:15%;">
                                                    <col style="width:35%;">
                                                    <col style="width:15%;">
                                                    <col style="width:35%;">
                                                </colgroup>
	                                            <tbody>
	                                                <tr>
	                                                    <th>총출자금</th>
	                                                    <td class="alignR pdr10"><span id="investAmt"></span> 원 (<span id="investNum"></span> 좌)</td>
	                                                    <th>출자담보금</th>
	                                                    <td class="alignR pdr10"><span id="mortAmt"></span> 원 (<span id="mortNum"></span> 좌)</td>
	                                                </tr>
	                                            </tbody>
	                                        </table>
	                                    </div>
                                    </div>
                                </article>
                                <article>
                                    <div class="table-wrap board">
                                        <div class="table-scroll v2">
                                            <table class="border">
												<colgroup>
                                                    <col style="width:7%;">
                                                    <col style="width:10%;">
                                                    <col style="width:15%;">
                                                    <col style="width:14%;">
                                                    <col style="width:12%;">
                                                    <col style="width:14%;">
                                                    <col style="width:14%;">
                                                    <col style="width:14%;">
                                                </colgroup>
                                                <thead class="back-gray">
                                                    <tr>
                                                        <th scope="col">순번</th>
                                                        <th scope="col">출자구분</th>
                                                        <th scope="col">출자일자</th>
                                                        <th scope="col">좌당액면가</th>
                                                        <th scope="col">출자좌수</th>
                                                        <th scope="col">출자금액</th>
                                                        <th scope="col">처리일자</th>
                                                        <th scope="col">처리상태</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="ele_invtReq"></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </section>
                        </form>
                    </div>
                </div>
            </div>
        </div>
</html>