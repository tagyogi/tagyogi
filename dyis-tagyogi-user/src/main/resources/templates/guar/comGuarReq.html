<!--
	파일정보 : comGuarReq.html
	파일명 : comGuarReq
	업무명 : 사이버보증 - 보증신청 정보(관리자 comGuarReqContr.hmtl + comGuarReqGuar.html)
	생성자 : 권다슬
	생성일 : 2023.08.30
-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xml:lang="ko">
	<body>
		<script th:inline="javascript">
			/*<![CDATA[*/
			$(document).ready(function(){
				//달력처리
				if(guarType === '14' && menuCd === '2030206')	$("#guarBegDt").val(/*[[${today}]]*/);	//선금급 신규등록일때 보증기간 오늘

				//신청정보 title(*** 정보)
				$("#txt_guarTypeNm").text(guarCom.fnSelectGuarTypeNm(guarType));

				//selectBox
				com.fnCodeSelectBox("GR07", "orderCd", 1, ""); 		//피공제기관
				
				//radioBox
				if(guarType === "21") com.fnCodeRadio("GR13", "ele_repayCd", "repayCd", false, "10"); //채무보증방법
				com.fnCodeRadio("GR08", "ele_contrCdArea", "contrCd", false, "E"); 		//계약방식
				com.fnCodeRadio("GR09", "ele_guarAddCdArea", "guarAddCd", false, "0"); 	//보증기간가산
				//보증기간가산 클릭 이벤트
				$("input[name=guarAddCd]").on("click",function(){
				    if($("#guarBegDt").val().length !== 10 || $("#guarExpDt").val().length !== 10) 	return;

					var addCd = Number($(this).val());
					$("#guarAddDays").val(addCd);
				    if(tmpGuarExpDt === undefined) 	tmpGuarExpDt = $("#guarExpDt").val();

				    // 보증종료일계산
				    $("#guarExpDt").val(com.fnDateGet(tmpGuarExpDt, addCd));

				    // 보증일수 계산
				    guarCom.fnSetGuarDays();
				});


				//체크박스 값 한개만 클릭되도록
				$("input[name=specContrs]").on("click", function(){
					if($(this).is(":checked")){
						$("input[name=specContrs]").prop("checked", false);
						$(this).prop("checked", true);
					}
				});
			});

			var fnGuarContrInputSet = function(){
				if(guarType === "11"){ //입찰
					$("#txt_servNm").html("<span class='reqMark'>*</span>입찰건명");
					$("#txt_contrAmt").html("<span class='reqMark'>*</span>입찰금액");

					$("#contrAmt").attr("title", "입찰금액");

				}else if(guarType === "13"){ //하자보수
					$("#txt_releDt").html("<span class='reqMark'>*</span>검수완료일");
					$("#releDt").attr("title", "검수완료일");

				}else if(guarType === "14"){ //선금급
					$("#txt_releDt").text("지급예정일");
					$("#releDt").attr("title", "지급예정일");
					$("#txt_guarRate").text("선금금율");
					$("#guarRate").attr("title", "선금금율");

				}else if(guarType === "21"){ //채무
					com.fnCodeRadio("GR14", "ele_debtWay", "debtWay", false, "10"); //계약방식

					$("#txt_servNm").html("<span class='reqMark'>*</span>대출과목");
					$("#txt_contrAmt").html("<span class='reqMark'>*</span>대출예정금액");
					$("#txt_contrTermDt").html("<span class='reqMark'>*</span>대출기간");

					$("#contrAmt").attr("title", "대출예정금액");
					$("#contrBegDt").attr("title", "대출시작일");
					$("#contrExpDt").attr("title", "대출종료일");

					$("#txt_befContrAmt").html("<span class='reqMark'>*</span>기존 대출예정금액");

				}else if(guarType === "32"){ //인허가

					$("#txt_contrTermDt").html("<span class='reqMark'>*</span>인·허가기간");

					$("#contrBegDt").attr("title", "인·허가시작일");
					$("#contrExpDt").attr("title", "인·허가종료일");

				}else if(guarType === "34"){ // 지급보증의지급

					$("#txt_contrTermDt").html("<span class='reqMark'>*</span>지급보증기간");
					$("#txt_contrAmt").html("<span class='reqMark'>*</span>지급보증금액");

					$("#contrBegDt").attr("title", "지급보증시작일");
					$("#contrExpDt").attr("title", "지급보증종료일");
					$("#contrAmt").attr("title", "지급보증금액");
				}
			}

			//피공제기관 검색 팝업
			var fnOrderSel = function(){
				com.dialpopupOpen("피공제기관", "/index/popPageCall.do?menuPage=com/serchOrder", "800", "500");	// 	menuCd=1070711
			}

			//피공제기관 검색 팝업 콜백
			var fnOrderSearchSet = function(resData){
				//console.log(resData);
				$("#orderCd").val(resData.orderCd);			//공공기관/민관기관 selectBox 선택
			    $("#orderNm").val(resData.orderNm);			//입찰건명
			    $("#orderBizNo").val(resData.orderBizNo);	//사업자번호

			    //보증수수료율 조회(순서 중요 : 조합원 정보 필요, 공공/민관 선택 필요)
				guarCom.fnSelectGuarRate();
			}

			//계약일수,약정일수 입력 이벤트
			var fnAddContrDay = function(){
				if($("#contrBegDt").val() === "") {
		            alert("시작일자를 입력해 주십시오.");
		            $("#contrDays").val("");
		            $("#contrBegDt").focus();
		            return;
		        }

		        $("#contrExpDt").val(com.fnDateGet($("#contrBegDt").val(), guarCom.fnToNumber($("#contrDays").val()) -1 )).focus();
		        $("#contrDays").focus();
			}

			//하자담보일수 입력 이벤트
			var fnAddReleDay = function(){
				if($("#releBegDt").val() === "") {
		            alert("시작일자를 입력해 주십시오.");
		            $("#releDays").val("");
		            $("#releBegDt").focus();
		            return;
		        }

		        $("#releEndDt").val(com.fnDateGet($("#releBegDt").val(), guarCom.fnToNumber($("#releDays").val()) - 1)).focus();
		        $("#releDays").focus();
			}

			//보증일수 입력 이벤트
			var fnAddGuarDay = function(){
				if($("#guarBegDt").val() === "") {
		            alert("시작일자를 입력해 주십시오.");
		            $("#guarDays").val("");
		            $("#guarBegDt").focus();
		            return;
		        }

				//focus는 onblur 이벤트 작동을 위한 코드같음..
		        $("#guarExpDt").val(com.fnDateGet($("#guarBegDt").val(), guarCom.fnToNumber($("#guarDays").val()) - 1)).focus();
		        $("#guarDays").focus();
			}

			//수정페이지(기존 데이터 체크박스,라디오박스 값 체크)
			var uptCheckValGuar = function(guar){
				com.checkBoxCheckValue(guar.guarAddCd, "guarAddCd");	//보증기간가산
				com.checkBoxCheckValue(guar.specContrs, "specContrs");	//특약
				com.checkBoxCheckValue(guar.koccaYn, "koccaYn");		//공공기관지원사업 여부
				com.checkBoxCheckValue(guar.contrCd, "contrCd");		//계약방식
				//com.checkBoxCheckValue(guar.g2bContCheck, "g2bContCheck");	//실제이행기일
			}

		    /*]]>*/
		</script>

		<p class="title-dept1"><span id="txt_guarTypeNm"></span> 정보</p>
		<div class="table-wrap info">
            <div class="table-scroll">
                <table summary="계약 정보">
					<colgroup>
                    	<col style="width:13%;">
                    	<col style="width:39%;">
                    	<col style="width:13%;">
                    	<col style="width:35%;">
                    </colgroup>
					<tbody>
						<tr>
							<th><span class="reqMark">*</span>신청일자</th>
							<td colspan="3">
								<input type="text" name="reqDt" id="reqDt" th:value="${today}" title="신청일자" style="width:120px" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this)" onblur="com.fnDateValiChk(this);" onchange="guarCom.fnSelectGuarRate();" readonly/>
							</td>
						</tr>

						 <!-- 계약,하자,선급금, 이행지급, 성능이행, 인허가, 상품판매 체결일정보 -->
						<th:block th:if="${#strings.equals(paramMap.refVal, '12') || #strings.equals(paramMap.refVal, '13') || #strings.equals(paramMap.refVal, '14') || #strings.equals(paramMap.refVal, '15') || #strings.equals(paramMap.refVal, '31') || #strings.equals(paramMap.refVal, '32') || #strings.equals(paramMap.refVal, '33') || #strings.equals(paramMap.refVal, '34') }">
						<tr>
							<!-- 지급보증의지급이 아닌경우 계약체결일 -->
							<th:block th:if="${!#strings.equals(paramMap.refVal,'34')}">
							<th><span class="reqMark">*</span>계약체결일</th>
							<td>
								<div class="al-center" style="width: 170px;">
									<input type="text" name="contrDt" id="contrDt" th:value="${today}" title="계약체결일자" maxlength="10" placeholder="YYYY-MM-DD" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this)" onblur="com.fnDateValiChk(this);" style="width:120px" autocomplete="off"/>
									<img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'contrDt', 'yyyy-mm-dd')" />
								</div>
							</td>
							</th:block>
							<!-- 지급보증의지급인 경우 지급보증종류 -->
							<th:block th:if="${#strings.equals(paramMap.refVal, '34')}">
							<th><span class="reqMark">*</span>지급보증종류</th>
							<td>
								<input type="text" name="perfKind" id="perfKind" title="지급보증종류" maxlength="50" style="width:300px" />
							</td>
							</th:block>

							<th id="txt_releDt">낙찰일자</th>
							<td>
								<div class="al-center" style="width: 170px;">
									<input type="text" name="releDt" id="releDt" title="낙찰일자" maxlength="10" placeholder="YYYY-MM-DD" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this);" onblur="com.fnDateValiChk(this)" style="width:120px" autocomplete="off"/>
									<img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'releDt', 'yyyy-mm-dd')" />
								</div>
							</td>
						</tr>
						</th:block>

						 <!-- 계약,하자,선급금, 이행지급, 채무, 성능이행, 인허가, 상품판매, 지급보증기간 계약기간 -->
						<th:block th:if="${#strings.equals(paramMap.refVal, '12') || #strings.equals(paramMap.refVal, '13')|| #strings.equals(paramMap.refVal, '14') || #strings.equals(paramMap.refVal, '15') || #strings.equals(paramMap.refVal, '31')|| #strings.equals(paramMap.refVal, '32') || #strings.equals(paramMap.refVal, '33') || #strings.equals(paramMap.refVal, '34')}">
						<tr>
							<th id="txt_contrTermDt" ><span class="reqMark">*</span>계약기간</th> <!-- 대출기간 -->
							<td>	<!--  colspan="3" -->
								<div class="flex-box al-center">
		                            <div class="flex-box al-center">
		                                <input type="text" name="contrBegDt" id="contrBegDt" value="" class="w-100" title="계약기간 시작일" placeholder="YYYY-MM-DD" maxlength="10" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this);guarCom.fnSetContrDays();" onblur="com.fnDateValiChk(this);guarCom.fnSetContrDays();" style="width:120px" autocomplete="off" />
                                    	<img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'contrBegDt', 'yyyy-mm-dd','contrExpDt', 1, guarCom.fnSetContrDays)" />
		                            </div>
		                            ~
		                            <div class="flex-box al-center">
		                                <input type="text" name="contrExpDt" id="contrExpDt" value="" class="w-100" title="계약기간 종료일" placeholder="YYYY-MM-DD" maxlength="10" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this);guarCom.fnSetContrDays();" onblur="com.fnDateValiChk(this);guarCom.fnSetContrDays();" style="width:120px" autocomplete="off" />
                                        <img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'contrExpDt', 'yyyy-mm-dd','contrBegDt', 2, guarCom.fnSetContrDays)" />
		                            </div>
		                            (<input type="text" name="contrDays" id="contrDays" title="계약일수" maxlength="4" style="width:60px" onkeyup="com.fnOnlyNum(this);fnAddContrDay()"/>일)
		                        </div>
							</td>
						</tr>
						</th:block>

						<!-- 인허가 장소 -->
						<th:block th:if="${#strings.equals(paramMap.refVal, '32')}">
						<tr>
							<th><span class="reqMark">*</span>인·허가장소</th>
							<td colspan="3">
								<input type="text" name="permPlace" id="permPlace" title="인·허가장소" maxlength="50" style="width:250px" value=""/>
							</td>
						</tr>
						</th:block>

						<!-- 하자보수보증 -->
						<th:block th:if="${#strings.equals(paramMap.refVal, '13')}">
						<tr>
							<th><span class="reqMark">*</span>하자담보기간</th>
							<td>	<!-- colspan="3" -->
								<div class="flex-box al-center">
		                            <div class="flex-box al-center">
		                                <input type="text" name="releBegDt" id="releBegDt" value="" class="w-100" title="하자담보 시작일" placeholder="YYYY-MM-DD" maxlength="10" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this);guarCom.fnSetReleDays();" onblur="com.fnDateValiChk(this);guarCom.fnSetReleDays();" style="width:120px" autocomplete="off" />
                                    	<img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'releBegDt', 'yyyy-mm-dd','releBegDt', 1, guarCom.fnSetReleDays)" />
		                            </div>
		                            ~
		                            <div class="flex-box al-center">
		                                <input type="text" name="releEndDt" id="releEndDt" value="" class="w-100" title="하자담보 종료일" placeholder="YYYY-MM-DD" maxlength="10" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this);guarCom.fnSetReleDays();" onblur="com.fnDateValiChk(this);guarCom.fnSetReleDays();" style="width:120px" autocomplete="off" />
                                        <img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'releEndDt', 'yyyy-mm-dd','releBegDt', 2, guarCom.fnSetReleDays)" />
		                            </div>
		                            (<input type="text" name="releDays" id="releDays" title="하자담보일수" maxlength="4" style="width:60px" onkeyup="com.fnOnlyNum(this);fnAddReleDay()"/>일)
		                        </div>
							</td>
						</tr>
						</th:block>

						<!-- 인허가 제외 -->
						<th:block th:if="${!#strings.equals(paramMap.refVal,'32')}">
						<tr>
							<th id="txt_contrAmt"><span class="reqMark">*</span>계약금액</th>
							<td>
								<input type="text" name="contrAmt" id="contrAmt" title="계약금액" maxlength="15" style="width:150px" value="" onkeyup="com.fnOnlyNum(this);com.makeComma(this);guarCom.fnSetGuarAmt();" />
							</td>
							<th><span class="reqMark">*</span><span id="txt_guarRate">보증금율</span></th> <!--선금금율-->
							<td >
								<input type="text" name="guarRate" id="guarRate" title="보증금율" maxlength="5" style="width:60px" value=""  onkeypress="" onkeyup="com.fnOnlyDecimal(this);guarCom.fnSetGuarAmt();" />&nbsp;%
							</td>
						</tr>
						</th:block>

						<th:block th:if="${#strings.equals(paramMap.refVal, '14')}"> <!-- 선금급보증 -->
						<tr>
							<th><span class="reqMark">*</span>선금금액</th>
							<td>
								<input type="text" name="repayAmt" id="repayAmt" title="선금금액" maxlength="15" style="width:150px" value="" onkeyup="com.fnOnlyNum(this);com.makeComma(this);guarCom.fnSetContrInterAmt();" />
							</td>
							<th id="txt_guarRate">약정이자액</th>
							<td>
								<input type="text" name="contrInterAmt" id="contrInterAmt" title="약정이자액" maxlength="15" style="width:140px" value="" readonly/>
								&nbsp;약정이자율
								<input type="text" name="contrInterRate" id="contrInterRate" title="약정이자율" maxlength="5" style="width:60px" value=""  onkeyup="com.fnOnlyDecimal(this);guarCom.fnSetContrInterAmt();" />&nbsp;%
								</br><span id="ele_guarPayRate"></span></br>
								(※ 한국은행 통계월보상 대출평균금리 참조)
							</td>
						</tr>
						</th:block>

						<!-- 입찰보증 -->
						<th:block th:if="${#strings.equals(paramMap.refVal, '11')}">
						<tr>
							<th><span class="reqMark">*</span>입찰마감일</th>
							<td colspan="3">
								<div class="al-center" style="width: 170px;">
									<input type="text" name="releDt" id="releDt" title="입찰마감일" maxlength="10" placeholder="YYYY-MM-DD" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this);guarCom.fnSetReleDt();" onblur="com.fnDateValiChk(this)" style="width:120px" autocomplete="off"/>
									<img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'releDt', 'yyyy-mm-dd', '', '', guarCom.fnSetReleDt)" />
								</div>
							</td>
						</tr>
						</th:block>

						<tr>	<!-- class="reqGuarDelArea" -->
							<th><span class="reqMark">*</span>보증금액</th>
							<td colspan="3">
								<input type="text" name="guarAmt" id="guarAmt" title="보증금액" maxlength="15" style="width:150px" value="" onkeyup="com.fnOnlyNum(this);com.makeComma(this); guarCom.fnCalcCommAmt();"/>
							</td>
						</tr>


						<tr>
							<th id="txt_servNm"><span class="reqMark">*</span>계약건명</th>
							<td colspan="3">
								<input type="text" name="servNm" id="servNm" title="계약건명" maxlength="100" style="width:800px" value="" />
							</td>
						</tr>

						<tr>
							<th><span class="reqMark">*</span>피공제기관</th>
							<td>
								<select name="orderCd" id="orderCd" title="기관구분" style="width:110px" ></select>	<!-- onchange="guarCom.fnSelectGuarRate();" -->
								<input type="text" name="orderNm" id="orderNm" title="피공제기관" maxlength="50" style="width:200px" value="" />
								<button type="button" class="address-btn3" onclick="fnOrderSel();"></button>
							</td>
							<th>사업자번호</th>
							<td>
								<input type="text" name="orderBizNo" id="orderBizNo" title="사업자번호" maxlength="12" onkeyup="com.fnOnlyNum(this);com.makeBizNo(this);"  style="width:140px" value="" />
							</td>
						</tr>

						<!-- 대출상환방법 -->
						<th:block th:if="${#strings.equals(paramMap.refVal, '21')}">
						<tr>
							<th>상환방법</th>
							<td colspan="3">
								<div id="ele_debtWay" title="상환방법"></div>
							</td>
						</tr>
						</th:block>

						<tr>	<!-- class="reqGuarDelArea" -->
							<th><span class="reqMark">*</span>보증기간</th>
							<td>
								<div class="flex-box al-center">
		                            <div class="flex-box al-center">
		                                <input type="text" name="guarBegDt" id="guarBegDt" value="" class="w-100" title="보증 시작일" placeholder="YYYY-MM-DD" maxlength="10" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this);guarCom.fnSetGuarDays();" onblur="com.fnDateValiChk(this);" autocomplete="off" />
                                    	<img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'guarBegDt', 'yyyy-mm-dd','guarExpDt', 1, guarCom.fnSetGuarDays)" />
		                            </div>
		                            ~
		                            <div class="flex-box al-center">
		                                <input type="text" name="guarExpDt" id="guarExpDt" value="" class="w-100" title="보증 종료일" placeholder="YYYY-MM-DD" maxlength="10" onkeyup="com.fnOnlyNum(this);com.fnDateMakeForm(this);guarCom.fnSetGuarDays();" onblur="com.fnDateValiChk(this);" autocomplete="off" />
                                        <img src="../images/icon_calendar.png" alt="달력" class="calendar-box" onclick="calendar(this, 'guarExpDt', 'yyyy-mm-dd','guarBegDt', 2, guarCom.fnSetGuarDays)" />
		                            </div>
		                            (<input type="text" name="guarDays" id="guarDays" title="보증일수" maxlength="4" style="width:60px" onkeyup="com.fnOnlyNum(this);fnAddGuarDay();"/>일)
		                            <input type="hidden" name="guarAddDays" id="guarAddDays" title="보증기간가산일수" value="0"/>
		                        </div>
							</td>

							<th><span class="reqMark">*</span>보증기간가산</th>
							<td><div id="ele_guarAddCdArea"></div></td>
						</tr>
						<tr>
							<th>보증내용</th>
							<td colspan="3">
								<input type="text" name="guarCont" id="guarCont"  value=""  maxlength="100" style="width:800px" />
							</td>
						</tr>

						<tr>
							<th>특약</th>
							<td colspan="3">
								<th:block th:if="${#strings.equals(paramMap.refVal, '11') || #strings.equals(paramMap.refVal, '12') || #strings.equals(paramMap.refVal, '13') || #strings.equals(paramMap.refVal, '14')}"> <!-- 입찰보증 -->
								<input type="checkbox" name="specContrs" value="1"/>&nbsp;공제금지급특별약관&nbsp;&nbsp;
								</th:block>

								<!-- 계약보증 -->
								<!--<th:block th:if="${#strings.equals(paramMap.refVal, '12')}">
								<input type="checkbox" name="g2bContCheck" value="Y"/>&nbsp;실제이행기일
								</th:block>-->

								<th:block th:if="${#strings.equals(paramMap.refVal, '15')|| #strings.equals(paramMap.refVal, '31') || #strings.equals(paramMap.refVal, '32') || #strings.equals(paramMap.refVal, '33') || #strings.equals(paramMap.refVal, '34')}"> <!-- 계약보증, 성능이행, 인허가, 상품팜내 -->
								<input type="checkbox" name="specContrs" id="specContrs_1" value="1"/>&nbsp;보증금지급특별약관&nbsp;&nbsp;
								<input type="checkbox" name="specContrs" id="specContrs_2" value="2"/>&nbsp;추가위험부담특별약관&nbsp;&nbsp;
								</th:block>

								<th:block th:if="${#strings.equals(paramMap.refVal, '21')}"> <!-- 채무보증 -->
								<input type="checkbox" name="specContrs" id="specContrs_3" value="3"/>&nbsp;특별출연업무협약&nbsp;&nbsp;
								<input type="checkbox" name="specContrs" id="specContrs_4" value="4"/>&nbsp;기업일반자금대출&nbsp;&nbsp;
								</th:block>

								<th:block th:if="${#strings.equals(paramMap.refVal, '15') || #strings.equals(paramMap.refVal, '31') || #strings.equals(paramMap.refVal, '32') || #strings.equals(paramMap.refVal, '33') || #strings.equals(paramMap.refVal, '34')}"> <!-- 이행지급, 성능이행, 인허가, 상품팜내 -->
								</br><input type="checkbox" name="koccaYn" value="Y" onclick="guarCom.fnKoccaChange();"/>&nbsp;공공기관지원사업 여부&nbsp;&nbsp;
								</th:block>
							</td>
						</tr>

						<!-- 계약보증, 이행지급, 성능이행, 인허가 -->
						<th:block th:if="${#strings.equals(paramMap.refVal, '12') || #strings.equals(paramMap.refVal, '15') || #strings.equals(paramMap.refVal, '31') || #strings.equals(paramMap.refVal, '32') || #strings.equals(paramMap.refVal, '34')}">
						<tr>
							<th>계약방식</th>
							<td colspan="3">
								<div id="ele_contrCdArea" title="계약방식"></div>
							</td>
						</tr>
						</th:block>

						<tr>
							<th>적요</th>
							<td colspan="3">
								<textarea name="remark" id="remark" rows="2" cols="70"></textarea>
							</td>
						</tr>

					</tbody>
				</table>
			</div>
		</div>
	</body>
</html>