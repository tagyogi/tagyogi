<!--
	시스템구분 : 홈페이지
	파일정보 : guarAcciCert.html
	파일명 : guarAcciCert.html
	업무명 : 공제금기관인증
	생성자 : 변성균
	생성일 : 2023.08.11
-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xml:lang="ko">

	<script th:inline="javascript">
		/*<![CDATA[*/
		var codeList = /*[[${codeList}]]*/ //공통코드

		//화면 초기화 처리 호출
		$(document).ready(function(){
			//lnb 세팅함수
			fnPageLnbSet(/*[[${menuInfo}]]*/); //lnb세팅

			com.fnCodeSelectBox("GR01", "sGuarType", 1, ""); //보증상품
			com.fnCodeSelectBox("CM01", "sPayWay", 1, ""); //결제방법

			//달력
			//from to
			//com.fnDateFromTo("ele_dateDt", "sPayStaDt", "sPayEndDt"); //시작~종료 달력
			//$("#btn_Dt").click(function(){ com.fnDateCalVisible($("#ele_dateDt"));  }); //달력버튼처리
			$("#sPayStaDt").val(com.fnDateGet(/*[[${today}]]*/, -364)); //

			//fnSerch();
		});

		//기관인증
		var fnSerchOderConf = function(){
			if($("#orderBizNo").val() === "") {
		        alert("사업자번호를 입력해 주십시오.");
		        $("#orderBizNo").focus();
		        return;
		    }

		    if($("#orderBizNo").val().replace(/-/g,"").length !== 10) {
		        alert("사업자번호를 올바르게 입력해 주십시오.");
		        $("#orderBizNo").focus();
		        return;
		    }

		    //전자서명확인
		    var bizno = $("#orderBizNo").val().replace(/-/g,"");
			var param = {plan:$("#certPlainText").val(), idn:bizno, loginYn: "Y"};

			com.fnCertSign(param);
		}

		//서명 콜백
		var fnCertSingCallBack = function(resData){
			//console.log(resData);
			//console.log('전자서명콜백');
			var sBizno = $("#orderBizNo").val().replace(/-/g,"");
			$("#signData").val(resData.signData);

			var param = {};
			param.acciBizNo = $("#orderBizNo").val().replace(/-/g,"");
			param.acciBizNm = ""; //전자서명리턴값으로 받아서 세팅해야함
			//서명성공시, 피공제기관 조회 성공시 현황으로 이동
			fnPage('2030504', param);

			//$("#sBizNo").val(sBizno);
			//사업자번호로 피공제기관이름 조회
			//obj = {url:"/acciGuar/selectAcciGuarReqMemb.do", formId:"serchFrm", callBack:fnAcciGuarMembBack, msgYn:"N", sessYn:"Y", loadYn:"Y"};
			//com.fnAjaxPost(obj);

		}

		//서명성공시, 피공제기관 조회 성공시 최종콜백
		/*var fnAcciGuarMembBack = function(resData){
			console.log(resData);
			$("#orderName").val(resData.data.membNm); //피공제기관 세팅

			var param = {};
			param.acciBizNo = resData.data.bizNo;
			param.acciBizNm = resData.data.membNm;

			//서명성공시, 피공제기관 조회 성공시 현황으로 이동
			fnPage('2030504', param);

		}*/

		//신청페이지 호출
		/*var fnReq = function(){
			var param = {};
			param.acciBizNo = "";
			param.acciBizNm = "";
			fnPage('2030505', param);
		}	*/


		/*]]>*/
	</script>
        <div class="main-top sub">
			<ul class="inner">
                <li class="move1"></li>
                <li class="move2"></li>
                <li class="move3"></li>
                <li class="move4"></li>
                <li class="move5"></li>
            </ul>
        </div>
        <div class="content-wrap">
            <div class="inner">
                <div class="content-box flex-box jc-between">
                    <!-- 업무 안내 영역 -->
                    <div id="lnb" class="lnb-wrap">
                        <h3 class="ko-bold h3-txt"></h3>

                    </div>

                    <!-- 업무 안내 영역 끝 -->
                    <div class="content-main">
						<!-- 경로 영역 시작 -->
                        <div th:insert="~{/fragments/subTitle}"></div>
                        <!-- 경로 영역 끝 -->
                        <form name="serchFrm" id="serchFrm" onSubmit="return false">
						<input type="hidden" th:name="_csrf" th:value="${_csrf?.token}"/>
						<input type="hidden" name="certPlainText" id="certPlainText" value="kocfc1234567890kocfc"/>
						<input type="hidden" name="signedCont" id="signedCont" value=""/>
						<input type="hidden" name="sBizNo" id="sBizNo" value=""/>
                        <section id="content" class="content">
                            <!-- 여기서부터 content -->
                            <div>
                                <article>
                                    <form action="" method="get" name="search">
										<input type="hidden" th:name="_csrf" th:value="${_csrf?.token}"/>
										<!--<div class="border-box">
											<ul>
												<li>- 진행중 또는 완료된 공제금청구건 조회하시려면 기관인증이 필요합니다.</li>
												<li>- 처음이시라면 하단의 공제금 신청을 이용하시기 바랍니다 (기관인증후 신청가능).</li>
												<li>- 공제금신청 및 조회에는 공인인증서가 필요합니다.</li>
											</ul>
										</div>
										<div class="search-wrap txt-border-wrap">
                                            <table class="block">
                                                <colgroup>
                                                    <col width="13%">
                                                    <col width="30%">
                                                    <col width="15%">
                                                    <col width="30%">
                                                    <col width="*">
                                                </colgroup>
                                                <tbody>
													<tr>
                                                        <th class="alignC">사업자번호</th>
                                                        <td>
															<input type="text" name="orderBizNo" id="orderBizNo" value="" class="w-100" title="사업자번호" maxlength="12" onkeyup="com.fnOnlyNum(this);com.makeBizNo(this);">
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <div class="alignR btn-position">
												<button class="sub-btn btn-black m-w-100" onClick="fnSerchOderConf();">기관인증</button>
											</div>
                                        </div>-->

                                        <div class="flex-box gap-20 m-col dot-list">
	                                        <ul class="border pd30 w-50 flex-box fd-col gap-10 m-w-100 al-center">
		                                        <li class="ko-bold font-28 mb20 w-100">
		                                            <span class="color-up">공제금신청</span> 안내
		                                        </li>
		                                        <li class="txt-dept1 mb10 w-100">
		                                            ※ 진행중 또는 완료된 공제금청구건 조회하시려면 기관인증이 필요합니다.</br>
		                                            ※ 처음이시라면 기관인증후 공제금 신청을 이용하시기 바랍니다. </br>
		                                            ※ 공제금신청 및 조회에는 공인인증서가 필요합니다.</br>
		                                        </li>
		                                    </ul>
											<ul class="border pd30 w-50 flex-box fd-col gap-10 m-w-100 al-center">
		                                        <li class="ko-bold font-28 mb20 w-100">
		                                            <span class="color-up">기관인증</span> 안내
		                                        </li>
		                                        <li class="txt-dept1 mb10 w-100">
		                                            ※ 사업자번호를 입력후 기관인증 버튼을 클릭해주세요.</br>
		                                        </li>
		                                        <li class="flex-box al-center gap-10 w-80 m-col t-w-100">
		                                            <span class="w-30 white-no mr3 m-w-100">사업자번호</span>
		                                            <input type="text" name="orderBizNo" id="orderBizNo" value="" class="w-100" title="사업자번호" maxlength="12" onkeyup="com.fnOnlyNum(this);com.makeBizNo(this);">
		                                        </li>
		                                        <li class="alignC mt30 w-100">
													<button type="button" class="sub-btn2 btn-color" onclick="fnSerchOderConf();">기관인증</button>
		                                        </li>
		                                    </ul>
										</div>

                                    </form>
                                </article>

                            </div>
                        </section>
                        </form>
                    </div>
                </div>
            </div>
        </div>
</html>