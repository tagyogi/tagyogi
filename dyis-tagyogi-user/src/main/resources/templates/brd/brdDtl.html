<!--
	시스템구분 : 홈페이지 (콘텐츠 화면 처리 영역)
	파일정보 : brdDtl.html
	파일명 : brdDtl.html
	업무명 : 홈페이지 (콘텐츠 화면 처리 영역)
	생성자 : 변성균
	생성일 : 2023.06.21
-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xml:lang="ko">
	
	<script th:inline="javascript">
		/*<![CDATA[*/
		//화면 초기화 처리 호출
		$(document).ready(function(){
			var brdRef = $("#brdRef").val(); //상세보기-부모게시판
			
			//lnb 세팅함수
			fnPageLnbSet(/*[[${menuInfo}]]*/, "", brdRef, '20404'); //lnb세팅
			
			//게시판 상세 메뉴경로 세팅
			$('h2').text($('#' + brdRef + '').text()); //메뉴명
			$('#menuPath').text($('#topMenu' + brdRef.substr(0, 3)).text()  + ' > ' + $('#' + brdRef ).text()  + ' > '); //메뉴경로
		
			//html를 공통으로 쓰고있기 때문에 호출한 게시판의 atthType을 꼭 넘겨주어야 첨부파일 조회가능
			var atthType = /*[[${paramMap.atthType}]]*/;
			
			//brd 기본세팅
			com.fnBrdDtlView(atthType);
			
			// 다운로드
			/*$("#downloadItem").click(function() {
			    $("#docFile").IBUpload("download");
			});*/
				
		});
		
		//답변 입력 팝업 
		var fnAnsPop = function(){
			$("#dialog3").dialog({
				title : "답변 등록", resizable: true, width : 500, height: 550, modal : true, 
	    	});
		}
		
		//저장
		var fnSave = function(valChks){
			//필수체크
			var valChks = ["ansCont1"];
			if(com.fnValChk(valChks)){
				if(confirm("등록 처리 하시겠습니까?")){
					$("#regNm").val($('#dialog3 #regNm1').val());
					$("#deptNm").val($('#dialog3 #deptNm1').val());
					$("#ansCont").val($('#dialog3 #ansCont1').val());
					
					$("#dialog3").remove();
					
					fnAns();
				}
			}	
		};
		
		//답변 등록
		var fnAns = function(){
			param = {};
			obj = {url:"/brd/insertAns.do", param:param, formId:"serch", callBack:fnAnscallback, msgYn:"N", sessYn:"N", loadYn:"N"};
			com.fnAjaxPost(obj); 
		}
		
		var fnAnscallback = function(resData){
			alert(resData.msg);
			fnPage('20202');
		}
		
		//아이비업로드 안될시 사용할 다운로드 샘플
		var fnDownloadFile = function(fileInfo){
			$("#saveFile")[0].reset();
			com.fnFileDownBrd(fileInfo);
		}
	
		//비밀글 팝업
		var chkpop = function(brdNo, brdSeq, brdRef, regPw){
			$("#regPw2").val('');
			$("#dialog2").dialog({
				title : "비밀글 입니다.", resizable: true, width : 300, height: 250, modal : true, 
        	});

        	//비밀글 비밀번호 일치여부
			$("#regPw2").keydown(function(e){
				if(e.keyCode === 13 ){
					if(String($("#regPw2").val()) === regPw){
		            	$("#dialog2").remove();
						com.fnBrdDtlPage(brdNo, brdSeq, brdRef);
					}else {
						alert('비밀번호가 일치하지 않습니다.');
					}
				}
			});
			
			$("#chkRegPw").click(function(){
				if(String($("#regPw2").val()) === regPw){
	            	$("#dialog2").remove();
					com.fnBrdDtlPage(brdNo, brdSeq, brdRef);
				}else {
					alert('비밀번호가 일치하지 않습니다.');
				}
			});
		}
		
		/*]]>*/
	</script>
        <div class="main-top sub">
			<ul class="inner">
                <li class="move1"></li>
                <li class="move2"></li>
                <li class="move3"></li>
                <li class="move4"></li>
                <li class="move5"></li>
            </ul>
        </div>
        <div class="content-wrap">
            <div class="inner">
                <div class="content-box flex-box jc-between">
                    <!-- 업무 안내 영역 -->
                    <div id="lnb" class="lnb-wrap">
                        <h3 class="ko-bold h3-txt"></h3>
                    </div>
                    

                    <!-- 업무 안내 영역 끝 -->
                    <div class="content-main">
						<!-- 경로 영역 시작 -->
                        <div th:insert="~{/fragments/subTitle}"></div>
                        <form name="saveFile" id="saveFile" method="post" onSubmit="return false;" action="">
							<input type="hidden" th:name="_csrf" th:value="${_csrf?.token}"/>
							<input type="hidden" name="atthType" th:value="${paramMap.atthType}"/>
							<!--<input type="hidden" name="atthNo" value=""/>
							<input type="hidden" name="atthSeq" value=""/>-->
						</form>
	                    <form name="serch" id="serch" method="post" onSubmit="return false;" action="">
							<input type="hidden" th:name="_csrf" th:value="${_csrf?.token}"/>
							<input type="hidden" name="menuCd" id="menuCd" th:value="${menuInfo.menuCd}"/>
							<input type="hidden" name="brdRef" id="brdRef" th:value="${paramMap.brdRef}"/>
							<input type="hidden" name="brdNo" id="brdNo" th:value="${paramMap.brdNo}"/>
							<input type="hidden" name="brdSeq" id="brdSeq" th:value="${paramMap.brdSeq}"/>
							<input type="hidden" name="regNm" id="regNm" value=""/>
							<input type="hidden" name="atthType" id="atthType" th:value="${paramMap.atthType}"/>
							<input type="hidden" name="membNm" id="membNm" th:value="${session.membNm}"/>
							<input type="hidden" name="deptNm" id="deptNm" value=""/>
							<input type="hidden" name="ansCont" id="ansCont" value=""/>
						
	                        <!-- 경로 영역 끝 -->
	                        <section id="content" class="content">
	                            <!-- 여기서부터 content -->
                             <div id="dialog2" style="display: none;">
									<div class="pd30">
										<label for="regPw2"> 비밀번호를 입력하세요. 
							            	<input type="password" name="regPw2" id="regPw2" class="mt10 w-100" value="" title="비밀글 비밀번호입력" autocomplete="off">
							        	</label>
							        	<div class="alignR"><button id="chkRegPw" class="sub-btn btn-color mt10">확인</button></div>
						        	</div>
						        </div>
	                            <div class="detail">
			                        <div id="dialog3" style="display: none;">
										<div class="pd30">
											<label for="regNm1">이름을 입력하세요. 
								            	<input type="text" name="regNm1" id="regNm1" value="" maxlength="20" title="이름" class="w-100 mt10 mb20" autocomplete="off">
								        	</label>
											<labe for="deptNm1">부서를 입력하세요. 
								            	<input type="text" name="deptNm1" id="deptNm1" value="" maxlength="20" title="부서" class="w-100 mt10 mb20" autocomplete="off">
								        	</label>
											<label for="ansCont1"><span style="color: red">*</span>답변을 입력하세요. 
								            	<textarea name="ansCont1" id="ansCont1" rows="5" cols="30" title="답변내용" class="w-100 mt10 mb20"></textarea>
								        	</label>
								        	<button class="sub-btn2 btn-color"><a onClick="fnSave();">등록</a></button>
							        	</div>
							        </div>
                                    <div class="detail-top">
                                        <p id="ele_brdSubj" class="ko-medium"></p>
                                        <ul class="flex-box">
                                            <li class="ko-medium">작성자 : <span class="ko-light">관리자</span></li>
                                            <li class="ko-medium">등록일 : <span id="ele_regDtm" class="ko-light"></span></li>
                                            <li class="ko-medium">조회수 : <span id="ele_viewCnt" class="ko-light"></span></li>
                                        </ul>
                                    </div>
                                    
                                    <div id="atthWrap" class="detail-file hide">
                                        <ul class="file">
                                            
                                        </ul>
                                    </div>
                                    <div id="brdCont" class="detail-txt brdCont">
                                        
                                    </div>
                                    
                                    <!--<div id="detail-file" class="mt20">
										<div class="alignR mb5">
				                           <button type="button" onclick="" id="downloadItem" class="btn-black sub-btn">다운로드</button>
				                        </div>
	                                    <article>
											<div id="docFile" style="height:140px;"></div>
		                                </article>
									</div>-->
	                                
                                    <ul id="pcPreNext">
                                        <li>
                                            <span class="nextSubj">다음글</span>
                                            <p class="ellipsis">
                                                <a href="#;" id="ele_nextSubj" title="다음글"></a>
                                            </p>
                                        </li>
                                        <li>
                                            <span class="prevSubj">이전글</span>
                                            <p class="ellipsis">
                                                <a href="#;" id="ele_prevSubj" title="이전글"></a>
                                            </p>
                                        </li>
                                    </ul>
                                    <div class="btn-wrap">
                                        <button type="button" id="btn-CallList" class="btn-black sub-btn2">목록</button>
                                        <button type="button" class="btn-white sub-btn2 page-left-icon onlyMobile">다음글</button>
                                        <button type="button" class="btn-white sub-btn2 page-right-icon onlyMobile">이전글</button>
                                    </div>
                                </div>
	                        </section>
                        </form>
                    </div>
                </div>
            </div>
        </div>
</html>