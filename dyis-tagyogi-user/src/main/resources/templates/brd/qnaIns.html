<!--
	시스템구분 : 홈페이지 (콘텐츠 화면 처리 영역)
	파일정보 : qnaIns.html
	파일명 : qnaIns.html
	업무명 : 홈페이지 (콘텐츠 화면 처리 영역)
	생성자 : 변성균
	생성일 : 2023.06.21
-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xml:lang="ko">
	
	<script th:inline="javascript">
		/*<![CDATA[*/
		
		//화면 초기화 처리 호출
		$(document).ready(function(){
			//lnb 세팅함수
			fnPageLnbSet(/*[[${menuInfo}]]*/, "질문과답변"); //lnb세팅
			
			//비밀글 Y: 비밀번호 활성화
			$("input[name='secrtYn']").on('change', function() {
  				if($('#secrtY').is(':checked')) {
					$("#regPw").removeAttr("disabled");
				} else {
   				 	$("#regPw").attr("disabled", "disabled");
   				 	$("#regPw").val("");
				}
			});
			
			//이메일 입력방식
			$("#selEmail").on('change', function() {
				$("#selEmail option:selected").each(function () {
	  				if($(this).val() === '0'){ //직접입력일 경우
						 $("#regEmail2").val(''); 
						 $("#regEmail2").removeAttr("disabled");
					}else{ //직접입력이 아닐경우
						 $("#regEmail2").val($(this).text());
						 $("#regEmail2").attr("disabled", "disabled");
					}
				});
			});
			
			
		});
		
		//저장
		var fnSave = function(valChks){
			//필수체크
			var valChks = ["userNm", "regPw", "brdSubj", "brdCont"];
			if($('#secrtN').is(':checked')) {
				valChks = ["userNm", "brdSubj", "brdCont"];
			}
			if(com.fnValChk(valChks)){
				fnChkPhoneMail();
			}	
		};
		
		//핸드폰 입력 시 자동하이픈
		var fnAutoHyphen = function(){
            $("#regTelNo").val(function(index, value) {
                return value.replace(/[^0-9]/g, '')
                            .replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g, "$1-$2-$3")
                            .replace(/(\-{1,2})$/g, "");
            });
        }
		
		//핸드폰, 이메일 체크
		var fnChkPhoneMail = function(){
			//핸드폰 형식 체크
			var regTelNo = $('#regTelNo').val();
			var regTelNoData = /(01[0|1|6|9|7])[-](\d{3}|\d{4})[-](\d{4}$)/g;
			
			if(regTelNo !== null && regTelNo !== ""){
				if(!regTelNoData.test(regTelNo)){
					alert('잘못된 휴대폰 번호입니다.');
					$('#phone').focus();
					return false;
				}
			}
			
			//이메일 형식 체크
			var regEmail1 =$("#regEmail1").val();
			var regEmail2 =$("#regEmail2").val();
			var regEmailData =  /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
			var regEmail ="";
			
			if(regEmail1 !== null && regEmail1 !== ""){
				if(!regEmail2){
					alert("도메인을 입력해주세요");
				    $("#regEmail2").focus();
				    return false;
				}
				
				regEmail = regEmail1 + "@" + regEmail2;
  				$("#regEmail").val(regEmail);  
  				
				if(!regEmailData.test(regEmail)){
					alert("이메일을 형식에 맞게 입력해주세요.");
					$('#regEmail1').focus();
					return false;
				}
			}
			
			if(confirm("등록 처리 하시겠습니까?")){
				fnQna();
			}
		}
		
		var fnQna = function(){
			param = {};
			obj = {url:"/brd/insertQna.do", param:param, formId:"qna", callBack:fnQnacallback, msgYn:"N", sessYn:"N", loadYn:"N"};
			com.fnAjaxPost(obj); 
		}
		
		var fnQnacallback = function(resData){
			alert(resData.msg);
			fnPage('20202');
		}
	    
		/*]]>*/
	</script>
        <div class="main-top sub">
			<ul class="inner">
                <li class="move1"></li>
                <li class="move2"></li>
                <li class="move3"></li>
                <li class="move4"></li>
                <li class="move5"></li>
            </ul>
        </div>
        <div class="content-wrap">
            <div class="inner">
                <div class="content-box flex-box jc-between">
                    <!-- 업무 안내 영역 -->
                    <div id="lnb" class="lnb-wrap">
                        <h3 class="ko-bold h3-txt"></h3>
                    </div>
                    

                    <!-- 업무 안내 영역 끝 -->
                    <div class="content-main">
						<!-- 경로 영역 시작 -->
                        <div th:insert="~{/fragments/subTitle}"></div>
	                    <form name="qna" id="qna" method="post" onSubmit="return false;" action="/insertQna.do">
							<input type="hidden" th:name="_csrf" th:value="${_csrf?.token}"/>
							<input type="hidden" name="menuCd" id="menuCd" th:value="${menuInfo.menuCd}"/>
							<input type="hidden" name="brdNo" id="brdNo" value="6"/>
							<input type="hidden" name="brdRef" id="brdRef" th:value="${menuInfo.refVal}"/>
							<input type="hidden" name="regEmail" id="regEmail" value=""/>
							<input type="hidden" name="viewYn" id="viewYn" value="Y"/>
						
	                        <!-- 경로 영역 끝 -->
	                        <section id="content" class="content">
	                            <!-- 여기서부터 content -->
	                            <div>
                                    <div class="table-wrap info">
                                        <div class="table-scroll">
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        <th>등록일</th>
                                                        <td class="ml10">
															<span th:text="${#calendars.format(#calendars.createNow(), 'yyyy-MM-dd')}"></span>
														</td>
                                                        <th>
                                                            <span class="reqMark">*</span>등록자
                                                        </th>
                                                        <td colspan="3" class="alignC">
                                                            <input type="text" name="userNm" id="userNm" value="" maxlength="20" title="등록자">
                                                        </td>
                                                    </tr>
                                                    <tr>
														<th>
                                                            <span class="reqMark">*</span>비밀글 여부
                                                        </th>
                                                        <td class="alignC">
                                                           <label for="secrtY" class="mr5">Y <input type="radio" name="secrtYn" id="secrtY" value="Y"></label>
                                                           <label for="secrtN" >N <input type="radio" name="secrtYn" id="secrtN" value="N" checked="checked"></label>
                                                        </td>
														<th>
                                                            <span class="reqMark">*</span>비밀번호
                                                        </th>
                                                        <td colspan="3" class="alignC">
                                                            <input type="password" name="regPw" id="regPw" value="" maxlength="20" title="비밀번호" autocomplete="off" disabled="disabled">
                                                        </td>
													</tr>
                                                    <tr>
                                                        <th>전화번호</th>
                                                        <td class="flex-box al-center jc-between">
                                                            <input type="text" name="regTelNo" id="regTelNo" onKeyPress="fnAutoHyphen();" maxlength="13">
                                                        </td>
                                                        <th>이메일</th>
                                                        <td colspan="3" class="alignC">
                                                            <div class="flex-box al-center jc-between">
                                                                <input type="text" name="regEmail1" id="regEmail1" value="" maxlength="50"> <span class="mrl-5">@</span>
                                                                <input type="text" name="regEmail2" id="regEmail2" value="" maxlength="50" class="mr5"> 
                                                                <select name="selEmail" id="selEmail" class="sel-search mr0">
                                                                    <option value="0">직접입력</option>
                                                                    <option value="naver.com">naver.com</option>
                                                                    <option value="daum.com">daum.com</option>
                                                                    <option value="gmail.com">gmail.com</option>
                                                                </select>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th><span class="reqMark">*</span>제목</th>
                                                        <td colspan="5"><input type="text" name="brdSubj" id="brdSubj" value="" maxlength="100" title="제목"></td>
                                                    </tr>
                                                    <tr>
                                                        <th><span class="reqMark">*</span>내용</th>
                                                        <td colspan="5"><textarea name="brdCont" id="brdCont" rows="15" cols="83" title="내용"></textarea></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="btn-wrap info">
                                        <button type="submit" class="btn-color sub-btn2" onClick="fnSave();">등록</button>
                                        <button type="button" class="btn-black sub-btn2 mb0" onClick="fnPage('20202'); return false;">목록</button>
                                    </div>
                                </div>
	                        </section>
                        </form>
                    </div>
                </div>
            </div>
        </div>
</html>