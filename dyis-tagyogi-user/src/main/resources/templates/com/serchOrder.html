<!--
	시스템구분 : 홈페이지 (콘텐츠 화면 처리 영역)
	파일정보 : serchOrder.html
	파일명 : serchOrder.html
	업무명 : 홈페이지 - 피공제기관 검색 팝업
	생성자 : 권다슬
	생성일 : 2023.08.31
-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xml:lang="ko">

<head>
   <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/css/jquery-ui.min.css">
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/font.css">
    <link rel="stylesheet" href="/css/content.css">
    <script src="/js/jquery-1.10.2.min.js"></script>
	<script src="/js/jquery-3.3.1.min.js"></script>
	<script src="/js/jquery-ui-1.10.3.js"></script>
	<script src="/js/jquery.modal.js"></script>
	<script src="/js/main.js"></script>
	<script src="/js/common.js"></script>
</head>

	<script>
		//화면 초기화 처리 호출
		$(document).ready(function(){
			$("#sOrderNm").val(parent.$("#orderNm").val());	//피공제기관명
			//피공제기관 조회
			fnSerchOrder();
		});


		//피공제기관 조회
		var fnSerchOrder = function(){
			$("#ele_loading").css("display","block"); //로딩바
			obj = {url:"/guar/selectOrderList.do", formId:"serchFrm", callBack:fnSerchOrderCallback, msgYn:"N", sessYn:"N", loadYn:"Y"};
			com.fnAjaxPost(obj);
		}

		//피공제기관 조회 콜백
		var fnSerchOrderCallback = function(resData){
			console.log("resData" + resData);

			//table 내용 추가
			var data = resData.data;
			$("#orderList").empty();

			if( data === ''){
				var html = '<tr><td colspan="3">검색 결과가 없습니다.</td><tr>';
				$("#orderList").append(html);
			}

			$.each(data, function(index, item) {
				var html  = '<tr onmouseover="this.className=\'mOver\'" onmouseout="this.className=\'mOut\'" style="cursor:pointer;" onclick="setOrderData(\''+item.orderCd+'\', \''+item.orderNm+'\', \''+item.orderBizNo+'\')">';
		            html += '	<td>'+ item.orderCdNm +'</td>';
					html += '	<td>'+ item.orderNm +'</td>';
					html += '	<td>'+ com.fnNvlChk(item.orderBizNo, "") +'</td>';
					html += '</tr>';

				$("#orderList").append(html);
			});
			$("#ele_loading").css("display","none"); //로딩바
		}

		//피공제기관정보 세팅
		var setOrderData = function(orderCd, orderNm, orderBizNo) {
			var param = {orderCd: orderCd, orderNm: orderNm, orderBizNo: com.fnNvlChk(orderBizNo, "")};
			parent.fnOrderSearchSet(param);
			parent.com.dialpopupClose();
		}
	</script>

<body>
    <!-- 업무 안내 영역 끝 -->
    <div class="popWrap">
		<!-- 경로 영역 시작 -->
        <form name="serchFrm" id="serchFrm" method="post" onSubmit="return false;">
			<input type="hidden" th:name="_csrf" th:value="${_csrf?.token}"/>
			<input type="hidden" name="sIgnoreYn" id="sIgnoreYn" value="Y"/>
            <!-- 경로 영역 끝 -->
            <section id="content" class="content">
                <!-- 여기서부터 content -->
                <div>
                    <div class="search-wrap txt-border-wrap  ">
                        <table class="block">
                            <colgroup>
                                <col width="20%">
                                <col width="45%">
                                <col width="*%">
                            </colgroup>
                            <tbody>
                                <tr>
                                    <th>피공제기관명</th>
                                    <td class="m-mb10">
                                        <div class="flex-box al-center gap-10">
                                            <input type="search" name="sOrderNm" id="sOrderNm" style="width:200px;" maxlength="50" />
											<!--<input type="checkbox" name="sIgnoreYn" id="sIgnoreYn" value="Y"/>&nbsp;제외포함-->
                                        </div>
                                    </td>
                                    <td class="alignR">
                                        <button onClick="fnSerchOrder()" class="sub-btn btn-black m-w-100">조회</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <article>
                        <div class="table-wrap board">
                            <div class="table-scroll v2">
                                <table>
                                    <caption>피공제기관 목록</caption>
                                    <thead class="back-gray">
                                        <tr>
											<th width="15%" scope="col">구분</th>
                                            <th width="55%" scope="col">피공제기관명</th>
                                            <th width="30%" scope="col">사업자등록번호</th>
                                        </tr>
                                    </thead>
                                    <tbody id="orderList">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </article>
                </div>
            </section>
        </form>
    </div>
</body>
</html>